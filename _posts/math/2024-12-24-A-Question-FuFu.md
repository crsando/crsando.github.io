---
layout: post
title: 一个比较有意思的组合数论问题
tags: math,education,algebra
category: math
---

*2014 复旦附中自招压轴题*

从$1,2,3,\cdots,2014$中，抽取$n$个数组成集合$A$，从$A$中任取$3$个数，总有一个数能够整除另一个，试求$n$的最大值。

***Solution***

最大的$n=21$，构造如下

$$
\begin{aligned}
    A = &\{ \\
        &\quad 1, 2, 2^2, \cdots, 2^{10}, \\    
        &\quad 3, 3 \cdot 2, 3 \cdot 2^2, \cdots, 2^{9} \\    
    &\}
\end{aligned}
$$

下面证明$n=21$是最大的。

### 1

记$m = 2014$

称集合$A$为“好的”，若从$A \subset \{1,2,3,\cdots,m\}$，且满足从$A$中任取$3$个数，总有一个数能够整除另外一个。


### 2

若一个集合$A$是“好的”，且$A$的所有元素至多只有一个素因子，即$A = \{ p^k\}$，则$A$中至多只有$11$个元素。（这是因为$2014 = m > p^k \geqslant 2^k $，因此$0 \leqslant k \leqslant 10$）

另一方面，若集合$A$是好的，且$1 \not in A$，则我们取$A' = A + \{1\}$，显然$A'$也是好的。

因此，以下我们均假定$A$中至少有两种不同的素因子，且$1 \in A$。

### 3

引理1：

若$A = \{p^{s_k} u_k | k =1,2,\cdots\}$，其中$p$是$A$的所有非$1$元素中最小的素因子，则$A' = \{2^{s_k} u_k | k = 1,2,\cdots\}$也是“好的”。

证明略。

### 4

引理2：

若$A = \{2^{s_k}p^{t_k} u_k | k =1,2,\cdots\}$，其中$p$是$A$的所有非$1$元素中除$2$以外的最小的素因子，则$A' = \{2^{s_k}3^{t_k} u_k | k = 1,2,\cdots\}$也是“好的”。

证明略。


引理1和引理2告诉我们，只需要考虑形如$A = \{2^s 3^t u\}$这样好的集合即可。

### 5

引理3：若集合$A$是好的，考虑$A$中元素的某个素因子$p$，即记$A = \{p^{s_k}u_k\}$，令$d = \min s_k$，则$A' = \{ p^{s_k - d + 1} u_k\}$也是好的。

证明略。（显然的）

### 6

引理4：

若集合$A$是“好的”，且集合$A$中的元素有三种不同的素因子，又由于引理1和引理2，我们不妨设这三种素因子为$2,3,p$（$p>3$），再由于引理3，我们不妨设$A$中存在一个元素$L = 2^s 3^t p u \in A$，其中$\gcd(p,u) = 1$，则必然存在一个数$K = 2^u 3^v \not \in A$，使得$A' = \{ t \in A, t \not = L\} + \{K\} $也是好的。

为证明引理4，只需要注意到如下三个数

$$
\begin{aligned}
    L &= 2^{s} 3^t p u \\
    K_1 &= 2^{s+1} 3^t \\
    K_2 &= 2^{s} 3^{t+1}
\end{aligned}
$$

显然$K_1 < L$以及$K_2 < L$

由于已知$L \in A$，若$K_1, K_2 \in A$，则$L,K_1,K_2$中不存在某个数能整除另一个数，与$A$是“好的”相矛盾。所以$K_1,K_2$中必然有一个不在$A$中，即为所求。

### 7

引理5：

若集合$A$是“好的”，则存在一个集合$A'=\{2^u 3^v\}$也是好的，满足$A$和$A'$的元素个数相同。

事实上，为证明引理5，只需要反复使用前面的引理1-5即可。

由引理1和引理2，我们不妨设$A$中最小的两个素因子为$2$和$3$。

若$A$中存在第三个素因子$p > 3$，则我们利用引理4，可以得到一个新的“好的”集合$A'$，满足$A$和$A'$的元素个数相同，且$A'$中含有$p$的因子的元素个数恰好比$A$少$1$

反复这么操作下去，最终得到一个集合$A'$中只有素因子$2,3$

### 8

引理6：若集合$A$是“好的”，且$L = 2^s 3^t \in A$，且满足$s ,t > 1$，则存在一个$K = 2^{u}3^{v}$，满足$s + t > u +v$，使得 $A' = \{ t \in A, t \not = L \} + \{ K \}$也是“好的”

事实上，只需要考虑如下三个数

$$
\begin{aligned}
    L &= 2^{s} 3^t \\
    K_1 &= 2^{s-2} 3^{t+1} \\
    K_2 &= 2^{s+1} 3^{t-2}
\end{aligned}
$$

显然$K_1 < L$以及$K_2 < L$

由于$s,t > 1$，故$s- 1 \geqslant 0$且$t -1\geqslant 0$，故这三个数中不存在某个数能够整除另一个数，故这三个数不能同时属于$A$。由于$L \in A$，所以$K_1, K_2$中总有一个不属于$A$，取这个不属于$A$的数为$K$，引理得正。

### 9 

引理7：若$A$是“好的”，则存在一个“好的”集合$A = \{ 2^{s_k} 3^{t_k}, k \in B \}$，满足$A$和$A'$的元素个数相等，且对任意$k \in B$，$s_k,t_k$中至少一个不大于$1$。

证明如下：先利用引理5，然后反复利用引理6即可。引理6不能无限重复下去（因为素因子的幂次之和不小于0），最后得到一个集合$A'$，即为所求。

### 10

引理8：若集合$A$是好的，若存在$u \geqslant 2$, $v \geqslant 3$满足$2 \cdot 3^u \in A$，$3 \cdot 2^v \in A$，则$2^{v+1} \not \in A$，且另$A' = \{t \in A, t \not = 2 \cdot 3^u\} + \{2^{2} \cdot 3^{u-1}\}$，则$A'$也是好的，且$A'$的元素个数与$A$相同。

证明略

### 11

由前述引理，不妨设$n$是所求的最大值，且$A$是一个元素个数为$n$的“好的”集合，由引理$7$，和引理8，我们总能得到一个集合$A'$，具有如下形式：

$$
\begin{aligned}
    B &= \{ 2^{s_1}, 2^{s_2}, \cdots 2^{s_u} \} \\
    C &= \{ 3 \cdot 2^{s_1}, 3\cdot 2^{s_2}, \cdots 3 \cdot 2^{s_u} \} \\
    A' &= \{1 \} + B + C
\end{aligned}
$$

其中$1 \leqslant t_1 \leqslant \cdots \leqslant t_u$，以及$0 \leqslant s_1 \leqslant \cdots \leqslant s_v$

显然$B$至多有$10$个元素，$C$最多有$10$个元素，所以$A$最多有$21$个元素。得证。